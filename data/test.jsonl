{"prompt": "Example of specific exception handling with requests (Timeout, HTTPError).", "completion": "import requests\n\nurls = ['https://httpbin.org/delay/5', 'https://httpbin.org/status/403', 'https://httpbin.org/get']\nfor url in urls:\n    try:\n        response = requests.get(url, timeout=2)\n        response.raise_for_status()\n        print(f'{url}: Success ({response.status_code})')\n    except requests.exceptions.Timeout:\n        print(f'{url}: Timed Out')\n    except requests.exceptions.HTTPError as e:\n        print(f'{url}: HTTP Error ({e.response.status_code})')\n    except requests.exceptions.RequestException as e:\n        print(f'{url}: Other Error ({e})')"}
{"prompt": "Iterate over streamed response lines with requests.", "completion": "import requests\n\nurl = 'https://httpbin.org/stream/3' # Stream 3 JSON lines\nlines_received = []\ntry:\n    with requests.get(url, stream=True) as r:\n        r.raise_for_status()\n        for line in r.iter_lines():\n            if line:\n                lines_received.append(line.decode('utf-8'))\n    print('Received lines:')\n    print(lines_received)\nexcept requests.exceptions.RequestException as e:\n    print(f'Error streaming lines: {e}')"}
{"prompt": "Process streamed bytes in chunks using `iter_content`.", "completion": "import requests\n\nurl = 'https://httpbin.org/bytes/2048' # Get 2KB of random bytes\nbyte_chunks = []\ntotal_bytes = 0\nwith requests.get(url, stream=True) as r:\n    r.raise_for_status()\n    for chunk in r.iter_content(chunk_size=512):\n        byte_chunks.append(chunk)\n        total_bytes += len(chunk)\nprint(f'Received {len(byte_chunks)} chunks, total {total_bytes} bytes.')"}
{"prompt": "Download a file chunk by chunk and save it.", "completion": "import requests\n\nurl = 'https://httpbin.org/image/jpeg' # Example file URL\nfilename = 'downloaded_image.jpeg'\ntry:\n    with requests.get(url, stream=True) as r:\n        r.raise_for_status()\n        with open(filename, 'wb') as f:\n            for chunk in r.iter_content(chunk_size=8192):\n                f.write(chunk)\n    print(f'File {filename} downloaded successfully.')\nexcept requests.exceptions.RequestException as e:\n    print(f'Error downloading file: {e}')\n# Optional: Add import os; os.remove(filename) for cleanup"}
{"prompt": "Example of `requests.patch` method.", "completion": "import requests\n\nurl = 'https://httpbin.org/patch'\ndata = {'field_to_update': 'new_value'}\nresponse = requests.patch(url, data=data)\nprint(f'Status: {response.status_code}')\nprint(f'Form data received by PATCH: {response.json().get(\"form\")}')"}
{"prompt": "Use `response.links` to find the 'next' page URL.", "completion": "import requests\n\n# Example with GitHub API (replace with actual URL if testing)\n# url = 'https://api.github.com/users/octocat/repos?per_page=5'\n# response = requests.get(url)\n\n# Simulate a response with links\nclass SimulatedResponse:\n    headers = {'Link': '<https://api.github.com/user/repos?page=2>; rel=\"next\"'}\n    links = {}\n\nresponse = SimulatedResponse()\nresponse.links = requests.utils.parse_header_links(response.headers.get('Link', ''))\n\nif 'next' in response.links:\n    next_url = response.links['next']['url']\n    print(f'The URL for the next page is: {next_url}')\nelse:\n    print('No next page link found.')"}
{"prompt": "Verify if response body contains 'httpbin'.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/robots.txt')\nif 'httpbin' in response.text.lower():\n    print('The word \"httpbin\" was found in the response.')\nelse:\n    print('The word \"httpbin\" was not found.')"}
{"prompt": "Make a GET request combining params, headers, and a timeout.", "completion": "import requests\n\nparams = {'query': 'example', 'limit': 10}\nheaders = {'Accept': 'application/vnd.api+json'}\ntimeout = 5.0 # seconds\n\ntry:\n    response = requests.get('https://httpbin.org/get', params=params, headers=headers, timeout=timeout)\n    response.raise_for_status()\n    print('Request successful.')\n    print('Args received:', response.json()['args'])\n    print('Headers received:', response.json()['headers'])\nexcept requests.exceptions.Timeout:\n    print('Request timed out.')\nexcept requests.exceptions.RequestException as e:\n    print(f'Request failed: {e}')"}
{"prompt": "Send a POST request with JSON data, custom headers, and auth.", "completion": "import requests\nfrom requests.auth import HTTPBasicAuth\n\njson_payload = {'data': 'payload'}\nheaders = {'X-Request-ID': '123-abc'}\nauth = HTTPBasicAuth('testuser', 'testpass')\n\nresponse = requests.post('https://httpbin.org/post', json=json_payload, headers=headers, auth=auth)\n\nprint(f'Status: {response.status_code}')\nprint('Received JSON:', response.json()['json'])\nprint('Received Headers:', response.json()['headers'])\nprint('Received Auth:', response.json().get('args')) # Basic auth info might appear here or need specific endpoint"}
{"prompt": "Example of a complex request using multiple requests options.", "completion": "import requests\n\nresponse = requests.request(\n    method='PUT', \n    url='https://httpbin.org/put', \n    params={'update_id': '5'}, \n    json={'status': 'complete'}, \n    headers={'X-Client': 'MyScript'}, \n    timeout=10\n)\n\nprint(f'Status: {response.status_code}')\nprint(response.json())"}
{"prompt": "POST data as plain text with requests.", "completion": "import requests\n\ndata = 'This is raw text data.'\nheaders = {'Content-Type': 'text/plain'}\n\nresponse = requests.post('https://httpbin.org/post', data=data, headers=headers)\nprint(f'Status: {response.status_code}')\nprint(f'Data received by server: {response.json().get(\"data\")}')"}
{"prompt": "Send XML data in a POST request.", "completion": "import requests\n\nxml_data = '<message><content>Hello</content></message>'\nheaders = {'Content-Type': 'application/xml'}\n\nresponse = requests.post('https://httpbin.org/post', data=xml_data, headers=headers)\nprint(f'Status: {response.status_code}')\n# httpbin will show the raw string in the 'data' field\nprint(f'Data received: {response.json().get(\"data\")}')"}
{"prompt": "How to send a list of values for a single form key in POST?", "completion": "import requests\n\n# Send multiple values for the key 'items'\npayload = {'items': ['apple', 'banana', 'cherry']}\n\nresponse = requests.post('https://httpbin.org/post', data=payload)\nprint(f'Status: {response.status_code}')\n# Check the 'form' field in the response JSON\nprint(f'Form data received: {response.json().get(\"form\")}')"}
{"prompt": "Pass tuples as data values in requests post.", "completion": "import requests\n\n# Useful for multipart/form-data if needed, but works for simple POST too\ndata = {'file_info': ('report.txt', 'content'), 'metadata': ('key', 'value')}\nresponse = requests.post('https://httpbin.org/post', data=data)\nprint(f'Status: {response.status_code}')\nprint(f'Form received: {response.json().get(\"form\")}')"}
{"prompt": "Check if a response was a redirect.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/redirect/1')\nif response.history: # History list is non-empty if redirects occurred\n    print('Request was redirected.')\n    print(f'Final URL: {response.url}')\n    print(f'Original status code: {response.history[0].status_code}')\nelse:\n    print('Request was not redirected.')"}
{"prompt": "Verify if the final response URL is different from the initial request URL.", "completion": "import requests\n\ninitial_url = 'https://httpbin.org/absolute-redirect/2'\nresponse = requests.get(initial_url)\n\nif response.url != initial_url:\n    print(f'Redirect occurred. Initial URL: {initial_url}, Final URL: {response.url}')\nelse:\n    print('No redirect occurred.')"}
{"prompt": "Use `response.is_redirect` property.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/redirect-to?url=https://example.com', allow_redirects=False)\n# Need allow_redirects=False to check the intermediate response\nif response.is_redirect:\n    print(f'Response is a redirect (Status: {response.status_code})')\n    print(f'Location header points to: {response.headers.get(\"Location\")}')\nelse:\n    print('Response is not a redirect.')"}
{"prompt": "Check if a redirect is permanent (301, 308).", "completion": "import requests\n\n# Need allow_redirects=False to check the intermediate response\nresponse = requests.get('https://httpbin.org/status/301', allow_redirects=False) \nif response.is_permanent_redirect:\n    print(f'Response is a permanent redirect (Status: {response.status_code})')\nelse:\n    print(f'Response is not a permanent redirect (Status: {response.status_code})')"}
{"prompt": "How to prepare a request without sending it using requests?", "completion": "import requests\n\nrequest = requests.Request('GET', 'https://httpbin.org/get', params={'key': 'val'}, headers={'X-Custom': 'Prep'}) \nprepared = request.prepare()\n\nprint('Prepared Request Details:')\nprint(f'Method: {prepared.method}')\nprint(f'URL: {prepared.url}')\nprint(f'Headers: {prepared.headers}')\nprint(f'Body: {prepared.body}')"}
{"prompt": "Use a Session to prepare a request object.", "completion": "import requests\n\nsession = requests.Session()\nsession.headers.update({'User-Agent': 'MySessionAgent'}) # Session headers\n\nreq = requests.Request('POST', 'https://httpbin.org/post', json={'data': 1})\nprepared_req = session.prepare_request(req)\n\nprint('Prepared Request (via Session):')\nprint(f'URL: {prepared_req.url}')\nprint(f'Headers: {prepared_req.headers}') # Will include session headers\nprint(f'Body: {prepared_req.body}')"}
{"prompt": "Manually create and send a PreparedRequest with a Session.", "completion": "import requests\n\ns = requests.Session()\nreq = requests.Request('GET', 'https://httpbin.org/get', headers={'X-Manual': 'Send'}) \nprepped = s.prepare_request(req)\n\n# Now send the prepared request\nresponse = s.send(prepped, timeout=5)\n\nprint(f'Status Code: {response.status_code}')\nprint(response.json()['headers'])"}
{"prompt": "Check a specific header value in the response.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/response-headers?Server=MyCustomServer/1.0')\nserver_header = response.headers.get('Server')\nprint(f'Server header value: {server_header}')\nif server_header == 'MyCustomServer/1.0':\n    print('Server header matches expected value.')"}
{"prompt": "Verify the Content-Type of a response.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/image/png')\nexpected_content_type = 'image/png'\nactual_content_type = response.headers.get('Content-Type', '').lower()\n\nif actual_content_type == expected_content_type:\n    print(f'Content-Type is correct: {actual_content_type}')\nelse:\n    print(f'Unexpected Content-Type. Expected: {expected_content_type}, Got: {actual_content_type}')"}
{"prompt": "How to get the raw socket response (advanced)?", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/get', stream=True)\n\ntry:\n    # Access the underlying urllib3 response\n    raw_response = response.raw\n    # You can read directly from raw_response, but requests handles encoding/decompression better\n    print(f'Underlying raw response object: {type(raw_response)}')\n    # Example: Read a small amount of raw data\n    # raw_data = raw_response.read(100)\n    # print(f'Raw data sample (first 100 bytes): {raw_data}')\nfinally:\n    # Important to release the connection if using raw\n    if 'raw_response' in locals():\n        raw_response.release_conn()"}
{"prompt": "Force requests to use a specific encoding for response text.", "completion": "import requests\n\nresponse = requests.get('https://httpbin.org/bytes/100') # Get raw bytes\nprint(f'Original detected encoding: {response.encoding}')\n\n# Force encoding (example assumes the bytes are actually valid UTF-8)\nresponse.encoding = 'utf-8'\n\ntry:\n    text_content = response.text\n    print(f'Text content after forcing encoding to {response.encoding}:')\n    # print(text_content) # This might fail if bytes aren't valid UTF-8\n    print('[Text content processed]')\nexcept UnicodeDecodeError as e:\n    print(f'Forcing encoding failed: {e}')"}
